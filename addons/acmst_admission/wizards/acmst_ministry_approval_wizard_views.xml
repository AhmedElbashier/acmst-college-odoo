<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Ministry Approval Wizard Form View -->
        <record id="acmst_ministry_approval_wizard_form" model="ir.ui.view">
            <field name="name">acmst.ministry.approval.wizard.form</field>
            <field name="model">acmst.ministry.approval.wizard</field>
            <field name="arch" type="xml">
                <form string="Ministry Approval">
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="admission_file_id" invisible="1"/>
                                Ministry Approval - <field name="applicant_name" readonly="1"/>
                            </h1>
                        </div>
                        
                        <group>
                            <group>
                                <field name="approver_id" readonly="1"/>
                                <field name="decision" required="1"/>
                                <field name="data_validated" readonly="1"/>
                            </group>
                            <group>
                                <field name="national_id" readonly="1"/>
                                <field name="phone" readonly="1"/>
                                <field name="email" readonly="1"/>
                            </group>
                        </group>
                        
                        <group>
                            <group>
                                <field name="program_id" readonly="1"/>
                                <field name="batch_id" readonly="1"/>
                            </group>
                        </group>
                        
                        <notebook>
                            <page string="Sensitive Data Review" name="sensitive_data">
                                <div class="alert alert-warning" role="alert">
                                    <strong>⚠️ SENSITIVE DATA REVIEW REQUIRED</strong><br/>
                                    This form contains sensitive personal information. Please carefully review all data below before proceeding with approval.
                                    By checking the acknowledgment box, you confirm that you have reviewed all sensitive information including:
                                    National ID, contact details, personal information, and educational records.
                                </div>

                                <group string="Personal Information" col="4">
                                    <field name="applicant_name"/>
                                    <field name="birth_date"/>
                                    <field name="gender"/>
                                    <field name="nationality"/>
                                </group>

                                <group string="Identification &amp; Contact" col="4">
                                    <field name="national_id" class_="text-danger" widget="char"/>
                                    <field name="phone" class_="text-danger" widget="phone"/>
                                    <field name="email" class_="text-danger" widget="email"/>
                                    <field name="address"/>
                                </group>

                                <group string="Emergency Contact" col="4">
                                    <field name="emergency_contact"/>
                                    <field name="emergency_phone" widget="phone"/>
                                </group>

                                <group string="Academic Information" col="4">
                                    <field name="program_id"/>
                                    <field name="batch_id"/>
                                    <field name="education_institution"/>
                                    <field name="education_program"/>
                                </group>

                                <group string="Educational Background" col="4">
                                    <field name="certificate_type"/>
                                    <field name="education_completion_year"/>
                                </group>

                                <group>
                                    <field name="acknowledge_sensitive_data" required="1"/>
                                    <div class="alert alert-info" role="alert" invisible="acknowledge_sensitive_data == False">
                                        <i class="fa fa-info-circle"/> Thank you for acknowledging the sensitive nature of this data. You can now proceed with approval.
                                    </div>
                                </group>

                                <div class="text-center" style="margin: 20px 0;">
                                    <button name="action_validate_data"
                                            type="object"
                                            string="Validate Student Data"
                                            class="btn btn-primary"
                                            invisible="data_validated == True"/>
                                    <div class="alert alert-success" role="alert"
                                         invisible="data_validated == False">
                                        <i class="fa fa-check-circle"/> Data validation completed successfully
                                    </div>
                                </div>
                            </page>
                            
                            <page string="University ID" name="university_id">
                                <div class="alert alert-warning" role="alert">
                                    <strong>University ID Entry</strong><br/>
                                    Enter the University ID provided by the ministry. If not available, 
                                    the student will be marked as "من طلاب المعالجات" for later processing.
                                </div>
                                
                                <group>
                                    <field name="has_university_id"/>
                                    <field name="university_id" 
                                           required="has_university_id == True"
                                           readonly="has_university_id == False"/>
                                </group>
                                
                                <div class="alert alert-info" role="alert" 
                                     invisible="has_university_id == True">
                                    <i class="fa fa-info-circle"/> Student will be marked as "من طلاب المعالجات" 
                                    and can be updated later when University ID becomes available.
                                </div>
                            </page>
                            
                            <page string="Comments" name="comments">
                                <field name="comments" placeholder="Enter any comments about the approval decision..."/>
                            </page>
                        </notebook>
                        
                        <footer>
                            <button name="action_approve"
                                    type="object"
                                    string="Approve"
                                    class="btn-primary"
                                    invisible="decision != 'approve' or not data_validated or not acknowledge_sensitive_data"/>
                            <button name="action_reject"
                                    type="object"
                                    string="Reject"
                                    class="btn-secondary"
                                    invisible="decision != 'reject' or not data_validated"/>
                            <button string="Cancel" class="btn-secondary" special="cancel"/>
                        </footer>
                    </sheet>
                </form>
            </field>
        </record>
        
        <!-- Ministry Approval Wizard Action -->
        <record id="acmst_ministry_approval_wizard_action" model="ir.actions.act_window">
            <field name="name">Ministry Approval</field>
            <field name="res_model">acmst.ministry.approval.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="view_id" ref="acmst_ministry_approval_wizard_form"/>
        </record>
        
    </data>
</odoo>
